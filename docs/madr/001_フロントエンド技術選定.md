# Architecture Decision Record: フロントエンド技術選定

- **日付**: 2025-03-11
- **ステータス**: 提案中 (Proposed)

## 1. 背景 (Context)

「zircon」は、以下を特徴とするタスク管理システムである。

- 無限に子タスクを生成可能なTODOアプリ
- 子タスク分解時にAIアシストを利用可能
- メンバーやグループによるタスクの作成／編集／閲覧／ステータス変更が可能
- タスク表示形式（表形式、カンバン、ツリー、ガントチャート）や各種検索機能・集計機能が豊富
- 通知やメンション機能があり、ステータス変更のルールに応じて通知が行われる

本プロジェクトのフロントエンドについては、以下の追加的な要求・前提がある。

- 技術的制約
  - ローカル環境ではDocker Composeを用いて動作させる
  - クラウド環境ではAWS上にデプロイする

これらの制約および要件を満たし、プロダクトのUI/UXを高い水準で実装・提供するためのフロントエンド技術（フレームワーク・ビルドツール・ホスティング環境など）を決定する必要がある。

## 2. 課題 (Problem)

1. **UIフレームワーク選定**
   - 大規模なタスク管理機能や、AIアシストを行うインタラクティブな画面操作を考慮すると、UIフレームワークとしてはReact、Vue.js、Angularといった定番のSPAフレームワークや、それを拡張したSSR(SSG)フレームワーク（Next.js, Nuxt.js など）が候補となる。
   - また、表示パフォーマンスや複雑な状態管理、拡張性を踏まえてフレームワークを選定する必要がある。
2. **ビルド/パッケージ管理ツール**
   - フロントエンドのビルドツールとしてWebpack、Vite、esbuildなどが考えられるが、近年はViteなどの高速ビルドツールが人気。
   - 開発体験やホットリロード、プラグインの充実度を考慮し選定する。
3. **Docker Compose対応**
   - ローカル環境ではDocker Composeを利用してバックエンドやDB、フロントエンドを含めたサービスを一括起動させることが要件となっている。
   - よって、フロントエンドもコンテナ化(例: Node.jsベースのコンテナ)する必要がある。
4. **AWSでのホスティング**
   - ホスティング先としては、Amazon S3 + CloudFront(静的ホスティング) または Amazon ECS(Fargate) などのコンテナオーケストレーションサービスが考えられる。
   - 現行の要件では、SPAの場合はS3 + CloudFrontがシンプルで有力な選択肢。SSRが必須の場合はEC2やECSなどのサーバホスティングが考えられる。

## 3. 決定 (Decision)

1. **フロントエンドフレームワーク**
   - React (Hooksベース) を採用する。
   - 理由: 開発者コミュニティが大きく、豊富なライブラリ群やプラグインがある。状態管理(Redux, Recoil, Zustandなど)を含めた柔軟な構成が可能。
   - UIコンポーネントライブラリ: Material UI等の成熟したUIライブラリを導入し、ダッシュボードやボード表示、ガントチャートなどの実装を効率化する。
2. **ビルドツール**
   - Viteを採用し、React + TypeScript 環境を構築する。
   - 理由: 高速ビルド・ホットリロード、設定のシンプルさから学習コストが低い。
3. **コンテナ化 (Docker Compose)**
   - フロントエンドはNode.jsのイメージをベースに、Vite開発環境を含むDockerfileを作成。
   - docker-compose.yml でバックエンド・DB・フロントエンドを一括管理する。
   - 開発時にはホットリロードが行えるように、ボリュームマウントやポートフォワードを設定する。
4. **AWSへのデプロイ**
   - **Productionビルドされた静的ファイル** (React/Vite のbuild成果物) はAWS S3にデプロイし、CloudFrontを経由して配信する。
   - 状態管理は基本的にクライアントサイドで行い、SSRが必須ではないためサーバレスホスティング(S3+CloudFront)を選択。
   - バックエンドAPIについてはAWS ECS/FargateもしくはAWS Lambda等が想定されるが、フロントエンドとしてはエンドポイント設定を行うのみ。

## 4. 選択肢 (Alternatives)

1. Vue 3 + Vite
   - ReactではなくVueを選択する場合の代替案。開発者経験やVueのシンプルな書き方を活用可能。
   - ただし、チームのReact経験が豊富であればReactを採用したほうが学習コストが低い。
2. Next.js
   - SSRやSSGを用いてSEO向上やページロード高速化を実施したい場合の代替案。
   - タスク管理アプリはログインユーザー中心でありSEO優先度が低いため、SPAでも問題ないと判断した。
3. Angular
   - 大規模開発に向いているが、学習コストがやや高い。チーム内に十分なAngular経験者がいるか要確認。

## 5. 根拠 (Rationale)

- **豊富なライブラリとコミュニティ**
   大規模なタスク管理画面やダッシュボード、カンバンなどを組む際、Reactのエコシステムを活用できるメリットが大きい。
- **Docker Compose 対応の容易さ**
   React + Vite はNodeベースであり、Dockerを活用したローカル開発が一般的なパターンとして確立されている。
- **AWSへの容易なデプロイ**
   SPAをS3 + CloudFrontで配信するワークフローはシンプルかつ運用実績が多い。デプロイの自動化（GitHub Actionsなど）との相性も良い。

## 6. 結果 (Consequences)

- ポジティブな影響
  - 開発者や利用可能なライブラリ・ノウハウが豊富なReactを採用することで、短期間で開発を進められる。
  - フロントエンドの静的ホスティングによりサーバレス構成となり、スケーラビリティとコスト効率に優れる。
- ネガティブな影響
  - SSRが必要な場合にはNext.jsなどの別フレームワークに移行する必要がある。
  - 運用フェーズでS3 + CloudFrontにビルド成果物をデプロイする手順の自動化が必要（CI/CDなどの整備）。

## 7. 実装方針 (Implementation Notes)

1. プロジェクト構成

   ```
   zircon-frontend/
   ├── docker/
   │   ├── Dockerfile  (Nodeベース, Viteビルド環境)
   │   └── ...
   ├── src/
   │   ├── components/ (Reactコンポーネント)
   │   ├── pages/      (Reactルーターで画面構成)
   │   └── ...
   ├── package.json
   └── vite.config.ts
   ```

2. docker-compose.yml

   - フロントエンド、バックエンド(APIサーバ)、DBの3コンテナ以上を定義し、`docker-compose up` で起動。
   - フロントエンドサービスは`vite dev` コマンドを起動しホットリロードを有効化。

3. デプロイプロセス

   - フロントエンドはCI/CDパイプラインで自動ビルドし、ビルド成果物をS3へデプロイ → CloudFrontを通して配信。
