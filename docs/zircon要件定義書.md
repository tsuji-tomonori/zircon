# zircon 要件定義書

## 1. 概要

### 1.1 プロジェクト概要

「zircon」

無限に子タスクを生成できるTODOアプリ。子タスク分解はAIアシストも利用可能。

### 1.2 プロジェクト目的・背景

近年、タスク管理ツールは多く存在するものの、複雑なプロジェクトや大規模なタスク分解が必要な現場では柔軟性に欠けるケースが多く見受けられます。
 「zircon」は、無限に子タスクを生成できるTODOアプリとして、個人の細かいタスク管理から、複数人によるウォーターフォールやアジャイル開発まで、あらゆる規模のプロジェクトに対応できる柔軟性と拡張性を実現することを目的としています。
 また、AIアシスト機能を組み込むことで、タスクの分解や整理を自動化・支援し、ユーザーの負担を軽減する点にも重点を置いています。

### 1.3 システム概要

- **無限に子タスク生成可能なTODOアプリ**
   タスクに対して無制限に子タスクを生成できる機能を搭載し、複雑なプロジェクトのタスク構造も直感的に管理できるように設計されています。
- **AIアシストによる子タスク分解**
   ユーザーが入力したタスク内容をAIが解析し、適切な子タスクへの分解を自動で提案する機能により、タスクの細分化作業を効率化します。

### 1.4 使用イメージ

- **個人でのタスク管理**
   日々の業務や生活の中で発生するタスクを階層的に整理し、効率的に管理するために利用できます。

- 複数人でのウォーターフォール/アジャイル開発での利用

  プロジェクトチーム全体でタスクを共有・分担し、各タスクの進捗や依存関係を明確に管理することが可能です。

  - ウォーターフォール開発では工程ごとのタスク管理に有効です。
  - アジャイル開発ではスプリント単位でのタスク分解や進捗管理に有効です。

### 1.5 ドキュメントの範囲

本ドキュメントは、「zircon」プロジェクトの要件定義書として、システムの概要、機能要件、非機能要件、および運用方針を記載します。具体的には以下の内容をカバーします。

- システムの目的と背景
- 提供する主要機能とその仕様
- ユーザーの利用想定
- システムの構成と設計方針
- セキュリティ、パフォーマンス、可用性などの非機能要件
- 今後の運用・保守方針

本ドキュメントは、開発チーム、プロジェクトマネージャー、およびステークホルダーが共通認識を持ち、システムの設計・実装・運用を適切に進めるための指針として使用されます。

## 2. 用語の定義・略語

### 2.1 用語の定義

| 用語               | 定義                                                         |
| ------------------ | ------------------------------------------------------------ |
| ユーザー           | システムにアクセスできる個人。プロジェクトに所属するとメンバーとなる。 |
| プロジェクト       | タスクを管理するための単位。メンバーが所属し、タスクの作成・管理を行う。 |
| メンバー           | プロジェクトに所属し、タスクの作成・編集・閲覧・ステータス変更ができるユーザー。 |
| プロジェクト管理者 | プロジェクトの管理権限を持ち、メンバーの管理やプロジェクト設定を行うユーザー。 |
| システム管理者     | システム全体を管理し、プロジェクトの作成やプロジェクト管理者の管理を行うユーザー。 |
| グループ           | プロジェクト内でメンバーをまとめる単位。グループ単位でタスクの担当者を設定できる。 |
| タスク             | 作業単位を示す要素。子タスクを持つことができ、各種属性を設定できる。 |
| 子タスク           | タスクに紐づくサブタスク。無制限に作成可能で、AIによる自動分解ができる。 |
| ステータス         | タスクの進捗状況を示す属性。プロジェクトごとにカスタマイズ可能。 |
| タグ               | タスクを分類するための要素。ユーザーが追加するものとシステムが設定するものがある。 |
| コメント           | タスクに対してメンバーが追加できるメッセージ。メンションを含むことができる。 |
| メンション         | コメントや詳細内でユーザーやグループを指定し、通知を行う機能。 |
| 通知               | メンションやタスクのステータス変更時に発生するアラート。UI上で確認可能。 |
| 表形式             | タスクをリスト形式で表示するビュー。                         |
| カンバン形式       | タスクをステータスごとに並べるビュー。                       |
| ツリー形式         | タスクの親子関係を木構造で表示するビュー。                   |
| ガントチャート形式 | タスクの開始日・終了日を視覚的に表示するビュー。             |
| AIアシスト         | タスクの子タスクを自動生成する機能。                         |
| ポイント           | タスクの工数や重要度を示す指標。                             |
| フィルタ           | タスクの検索・絞り込みに使用する機能。                       |
| 集計画面           | タスクの進捗や状況を可視化する画面。ステータス比率やバーンダウンチャートなどが含まれる。 |
| ロール             | ユーザーの権限を定義する概念。メンバー、プロジェクト管理者、システム管理者がある。 |
| アクセス権限       | ユーザーが実行可能な操作範囲を決定するルール。               |

### 2.2 略語

| 略語 | 意味                                                         |
| ---- | ------------------------------------------------------------ |
| AI   | Artificial Intelligence（人工知能）                          |
| UI   | User Interface（ユーザーインターフェース）                   |
| TLS  | Transport Layer Security（通信の暗号化技術）                 |
| SSL  | Secure Sockets Layer（通信の暗号化技術の旧バージョン）       |
| API  | Application Programming Interface（アプリケーション間のインターフェース） |
| DB   | Database（データベース）                                     |
| UX   | User Experience（ユーザーエクスペリエンス）                  |
| RBAC | Role-Based Access Control（ロールベースアクセス制御）        |

## 3. システム全体構成・アーキテクチャ

本章では、「zircon」システムの全体構成と、主要コンポーネントの概要を示します。
本システムは、大きく **フロントエンド（ブラウザ側）** と **バックエンド（サーバ側）** 、そして **データベース** を中心に構成され、AIアシストや通知機能などを組み合わせることで、無限に子タスクを生成可能なタスク管理アプリとして動作します。

### 3.1 システム構成図

以下に、本システムの概略構成図を示します（ローカル開発・AWS本番環境いずれも同様の論理構成）。本番環境では、フロントエンドをS3+CloudFront、バックエンドをLambda(API Gateway経由)、DBをAurora Serverless (PostgreSQL互換) としてサーバレスに運用する形を想定しています。

```
┌──────────────┐
│   ユーザー     │
│ (ブラウザ)     │
└─────▲────────┘
      │ (HTTP/S)
      │
      │ フロントエンド(React + Vite)
      ▼
┌──────────────────────┐
│  zircon フロントエンド  │
│ (S3 + CloudFront など)│
└─────────▲────────────┘
          │ (API呼び出し: HTTP/S)
          │
          ▼
┌───────────────────────┐
│  zircon バックエンド    │
│  (Node.js + Hono API) │
│    + AIアシスト機能     │
└─────────▲─────────────┘
          │ (DB接続)
          │
          ▼
┌───────────────────────┐
│   データベース          │
│ (PostgreSQL / Aurora) │
└───────────────────────┘
```

＜主な機能連携＞
- フロントエンド: タスク管理画面の表示、タスク操作（作成/編集/ステータス変更など）
- バックエンド: タスクCRUD・子タスク生成(AIアシスト)、通知制御、権限管理
- DB: タスク情報、メンバー/グループ情報、ステータス・コメント等を永続化
- AIアシスト: バックエンド内もしくは外部APIを利用し、子タスクの自動分解提案を行う
- 通知: ステータス変更やメンションに応じて、担当者・グループへ通知

### 3.2 各コンポーネント概要

#### (1) フロントエンド

- **役割**
  ブラウザ上で動作するユーザーインターフェース（UI）を提供し、タスクやプロジェクト、メンバー管理などの操作を行います。
  表形式・カンバン・ツリー・ガントチャートなど、複数の表示モードを切り替えてタスクを視覚的に管理可能です。
  コメントでのメンションやタグ検索、全文検索などのインタラクションを担当します。

- **主な技術**
  - React + TypeScript + Vite
  - (本番環境) S3 + CloudFront による静的ファイル配信
  - メンションや通知用のUI部品、Markdown対応エディタなど

- **ポイント**
  - ユーザー認証後、APIトークンやセッション管理によりバックエンドと連携
  - タスクの階層構造（子タスクのツリー表示）やドラッグ＆ドロップ操作（カンバン形式）などUI/UXに注力

#### (2) バックエンド

- **役割**
  タスク管理の中心的なビジネスロジックを提供し、フロントエンドからのリクエストに応じてタスクの作成/編集/閲覧/削除、子タスク生成(AIアシスト)などを行います。
  また、ステータス変更時のルール判定や通知処理（担当者・グループへのメンション通知等）を担い、アクセス権限やロール管理（メンバー/プロジェクト管理者/システム管理者）も実装します。

- **主な技術**
  - Node.js + TypeScript
  - フレームワーク: [Hono](https://hono.dev/)
    - 軽量・高パフォーマンスでREST API実装がしやすい
  - AIアシスト: タスクの内容から子タスクを自動生成する機能を外部APIや独自モデルで実装可能

- **ポイント**
  - ステータス遷移時の通知ロジックや、グループ担当タスクの通知先判定など複雑なビジネスルールを実装
  - ロール別(メンバー/プロジェクト管理者/システム管理者)の操作制御
  - CI/CDやIaC(AWS CDK)と連携してサーバレス(Lambda)にデプロイする想定

#### (3) データベース

- **役割**
  プロジェクト情報、メンバー・グループ、タスク/子タスク、コメント、ステータス、タグなどを永続的に保存します。無限階層の子タスク構造や、検索・集計に対応するデータスキーマを用います。

- **主な技術**
  - PostgreSQL
    - ローカル開発ではDocker Compose上で起動
    - 本番ではAurora Serverless v2 (PostgreSQL互換)を利用し、スケーラブルかつアイドル時コストを最小化
  - ORM: Prisma (TypeScript対応)
    - スキーマ駆動開発を行い、マイグレーションや型安全なDBアクセスを実現

- **ポイント**
  - タスクの階層管理に対応するためのテーブル設計（親タスクIDをもつ形式、再帰クエリ、または拡張機能など）
  - 検索や集計（タグ別ステータス比率、バーンダウンチャート用データ、期限切れ/本日期限一覧など）に最適化したインデックス設計
  - Prismaでマイグレーションを管理し、CI/CDパイプラインから本番DBに安全に適用

#### (4) AIアシスト（子タスク自動生成機能）

- **役割**
  ユーザーが登録したタスク内容を分析し、サブタスクを自動生成する機能。大きなタスクを分解して管理しやすくする役割を果たします。
  例えば「要件定義書作成」のタスクに対してAIが複数の小タスク（「ヒアリング」「ドキュメント構成決定」「レビュー」など）を提案するイメージ。

- **主な技術・実装形態**
  - (簡易的に) バックエンド内で外部のAPI（OpenAIなど）を呼び出し、生成結果をタスクとして登録
  - または自前推論サーバをDockerコンテナ化し、バックエンドと連携して生成

- **ポイント**
  - 大量アクセス時の負荷対策（キャッシュや非同期ジョブ化など）が必要
  - 提案されたサブタスクをユーザーが編集・採用できるUI側との連携

#### (5) 通知・メンション機能

- **役割**
  コメント中でのメンションやステータス変更時に、自動的に担当者・関係者へ通知を行います。タスク担当者がグループの場合はグループ内メンバーへの一斉通知などの細かい挙動を管理します。

- **主な技術**
  - バックエンドからユーザー情報を参照し、通知フラグなどを管理
  - フロントエンドのUIで通知一覧を表示
  - リアルタイム性が必要なら、WebSocketやサードパーティのプッシュサービス活用も検討

- **ポイント**
  - どのイベントで誰に通知するかをプロジェクト管理者が細かく設定できる
  - 通知先が複数のメンバー・グループになる場合の制御ロジック

#### (6) インフラ・運用

- **ローカル開発**
  - Docker Compose でフロントエンド、バックエンド、DB(PostgreSQL)を一括起動
  - ホットリロードによりスムーズに開発可能

- **本番運用（AWS）**
  1. **フロントエンド**: S3 + CloudFront
  2. **バックエンド**: AWS Lambda（API Gateway経由）
  3. **DB**: Aurora Serverless v2 (PostgreSQL)
  4. **CI/CD**: GitHub Actions + AWS CDK
     - PR時にビルド/テスト
     - マージ後にステージング→本番へ自動デプロイ(承認ステップ付き)

- **ポイント**
  - サーバレス構成でアイドル時のコストを最小化
  - CDKでIaC(インフラ構成)をコード管理し、アプリ変更と同時にレビュー・デプロイを行う
