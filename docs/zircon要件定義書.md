# zircon 要件定義書

## 1. 概要

### 1.1 プロジェクト概要

「zircon」

無限に子タスクを生成できるTODOアプリ。子タスク分解はAIアシストも利用可能。

### 1.2 プロジェクト目的・背景

近年、タスク管理ツールは多く存在するものの、複雑なプロジェクトや大規模なタスク分解が必要な現場では柔軟性に欠けるケースが多く見受けられます。
 「zircon」は、無限に子タスクを生成できるTODOアプリとして、個人の細かいタスク管理から、複数人によるウォーターフォールやアジャイル開発まで、あらゆる規模のプロジェクトに対応できる柔軟性と拡張性を実現することを目的としています。
 また、AIアシスト機能を組み込むことで、タスクの分解や整理を自動化・支援し、ユーザーの負担を軽減する点にも重点を置いています。

### 1.3 システム概要

- **無限に子タスク生成可能なTODOアプリ**
   タスクに対して無制限に子タスクを生成できる機能を搭載し、複雑なプロジェクトのタスク構造も直感的に管理できるように設計されています。
- **AIアシストによる子タスク分解**
   ユーザーが入力したタスク内容をAIが解析し、適切な子タスクへの分解を自動で提案する機能により、タスクの細分化作業を効率化します。

### 1.4 使用イメージ

- **個人でのタスク管理**
   日々の業務や生活の中で発生するタスクを階層的に整理し、効率的に管理するために利用できます。

- 複数人でのウォーターフォール/アジャイル開発での利用

  プロジェクトチーム全体でタスクを共有・分担し、各タスクの進捗や依存関係を明確に管理することが可能です。

  - ウォーターフォール開発では工程ごとのタスク管理に有効です。
  - アジャイル開発ではスプリント単位でのタスク分解や進捗管理に有効です。

### 1.5 ドキュメントの範囲

本ドキュメントは、「zircon」プロジェクトの要件定義書として、システムの概要、機能要件、非機能要件、および運用方針を記載します。具体的には以下の内容をカバーします。

- システムの目的と背景
- 提供する主要機能とその仕様
- ユーザーの利用想定
- システムの構成と設計方針
- セキュリティ、パフォーマンス、可用性などの非機能要件
- 今後の運用・保守方針

本ドキュメントは、開発チーム、プロジェクトマネージャー、およびステークホルダーが共通認識を持ち、システムの設計・実装・運用を適切に進めるための指針として使用されます。

## 2. 用語の定義・略語

### 2.1 用語の定義

| 用語               | 定義                                                         |
| ------------------ | ------------------------------------------------------------ |
| ユーザー           | システムにアクセスできる個人。プロジェクトに所属するとメンバーとなる。 |
| プロジェクト       | タスクを管理するための単位。メンバーが所属し、タスクの作成・管理を行う。 |
| メンバー           | プロジェクトに所属し、タスクの作成・編集・閲覧・ステータス変更ができるユーザー。 |
| プロジェクト管理者 | プロジェクトの管理権限を持ち、メンバーの管理やプロジェクト設定を行うユーザー。 |
| システム管理者     | システム全体を管理し、プロジェクトの作成やプロジェクト管理者の管理を行うユーザー。 |
| グループ           | プロジェクト内でメンバーをまとめる単位。グループ単位でタスクの担当者を設定できる。 |
| タスク             | 作業単位を示す要素。子タスクを持つことができ、各種属性を設定できる。 |
| 子タスク           | タスクに紐づくサブタスク。無制限に作成可能で、AIによる自動分解ができる。 |
| ステータス         | タスクの進捗状況を示す属性。プロジェクトごとにカスタマイズ可能。 |
| タグ               | タスクを分類するための要素。ユーザーが追加するものとシステムが設定するものがある。 |
| コメント           | タスクに対してメンバーが追加できるメッセージ。メンションを含むことができる。 |
| メンション         | コメントや詳細内でユーザーやグループを指定し、通知を行う機能。 |
| 通知               | メンションやタスクのステータス変更時に発生するアラート。UI上で確認可能。 |
| 表形式             | タスクをリスト形式で表示するビュー。                         |
| カンバン形式       | タスクをステータスごとに並べるビュー。                       |
| ツリー形式         | タスクの親子関係を木構造で表示するビュー。                   |
| ガントチャート形式 | タスクの開始日・終了日を視覚的に表示するビュー。             |
| AIアシスト         | タスクの子タスクを自動生成する機能。                         |
| ポイント           | タスクの工数や重要度を示す指標。                             |
| フィルタ           | タスクの検索・絞り込みに使用する機能。                       |
| 集計画面           | タスクの進捗や状況を可視化する画面。ステータス比率やバーンダウンチャートなどが含まれる。 |
| ロール             | ユーザーの権限を定義する概念。メンバー、プロジェクト管理者、システム管理者がある。 |
| アクセス権限       | ユーザーが実行可能な操作範囲を決定するルール。               |

### 2.2 略語

| 略語 | 意味                                                         |
| ---- | ------------------------------------------------------------ |
| AI   | Artificial Intelligence（人工知能）                          |
| UI   | User Interface（ユーザーインターフェース）                   |
| TLS  | Transport Layer Security（通信の暗号化技術）                 |
| SSL  | Secure Sockets Layer（通信の暗号化技術の旧バージョン）       |
| API  | Application Programming Interface（アプリケーション間のインターフェース） |
| DB   | Database（データベース）                                     |
| UX   | User Experience（ユーザーエクスペリエンス）                  |
| RBAC | Role-Based Access Control（ロールベースアクセス制御）        |

## 3. システム全体構成・アーキテクチャ

### 3.1 システム構成図

以下のシステム構成図は、本番環境が AWS を利用する場合のイメージ例です。ローカル開発では Docker Compose を活用し、フロントエンド・バックエンド・DB を同一ネットワーク内で起動する構成に置き換わります。

```mermaid
architecture-beta
    group aws(cloud)[AWS]
    
    service s3(logos:aws-s3)[S3バケット] in aws
    service cloudfront(logos:aws-cloudfront)[CloudFront] in aws
    service api_gateway(logos:aws-api-gateway)[API Gateway] in aws
    service lambda_backend(logos:aws-lambda)[バックエンド (Lambda)] in aws
    service aurora_db(logos:aws-rds)[Aurora Serverless v2 (PostgreSQL)] in aws
    service bedrock_ai(logos:aws-bedrock)[Amazon Bedrock] in aws

    group user_group[internet][ユーザー]
    service user_browser(internet)[ブラウザ] in user_group

    user_browser:R -- L:cloudfront
    cloudfront:R -- L:s3
    user_browser:B -- T:api_gateway
    api_gateway:R -- L:lambda_backend
    lambda_backend:B -- T:aurora_db
    lambda_backend:R -- L:bedrock_ai

```

- **ローカル開発時（Docker Compose）**  
  - フロントエンド: React+Vite を Node.js コンテナで起動  
  - バックエンド: Node.js(Hono) + Prisma をコンテナで起動  
  - DB: PostgreSQL コンテナ  
  - AI アシスト: 必要に応じてモック実装や外部 API を呼ぶ方法で代替検証

- **本番運用時（AWS）**  
  - フロントエンド成果物（HTML/CSS/JS）は S3 に配置し、CloudFront を経由してユーザーへ高速配信  
  - バックエンドは AWS Lambda（Node.js）上で稼働し、API Gateway（HTTP API）から呼び出される  
  - データベースは Amazon Aurora Serverless v2 (PostgreSQL互換) を利用し、タスクやユーザー情報を永続化  
  - AI アシスト機能は Lambda 内で Amazon Bedrock を呼び出し、生成 AI による子タスク提案などを行う  

### 3.2 各コンポーネント概要

#### 3.2.1 フロントエンド (React + TypeScript + Vite)

- **役割**  
  - ユーザーが操作する Web UI を提供する。  
  - タスクの作成・編集、ステータス変更、コメント投稿などの機能を画面上から実行できるようにする。  
  - カンバン形式・ツリー形式・ガントチャート形式など、さまざまな表示方法でタスクを視覚的に管理。  

- **主な機能**  
  - **タスク管理画面**  
    - タスク一覧やカンバン、ツリー構造での表示  
  - **コメント・メンション**  
    - 特定のユーザーやグループをメンションし、通知を発行  
  - **タグ・ステータス検索**  
    - ユーザーが付与したタグや、ステータスごとのフィルタ検索  
  - **集計レポート画面**  
    - ステータス比率の円グラフ、バーンダウンチャート、ポイント消化率表示など  

- **本番環境デプロイ**  
  - ビルド成果物を S3 に配置し、CloudFront で配信  
  - HTTPS(ACM 証明書) ＋ 独自ドメイン(Route53) との連携によりセキュアアクセスを実現  

#### 3.2.2 バックエンド (Node.js + Hono)

- **役割**  
  - フロントエンドからの API リクエストを受け取り、タスクやプロジェクト管理のロジックを実行。  
  - データベース(PostgreSQL)とのやりとりや、**Amazon Bedrock** を活用した AI アシストの呼び出し、通知配信などを担う。  

- **主な機能**  
  - **タスク管理 API**  
    - タスク作成・編集・ステータス変更・子タスク自動生成(後述の AIアシスト)  
    - タグ付与、ポイント設定、担当者割り当てなど  
  - **コメント・メンション API**  
    - コメント投稿の保存、メンションされたユーザーへの通知  
  - **ユーザー・グループ管理 API**  
    - プロジェクトへのメンバー追加・除外、グループ作成・編集、ステータス遷移権限の制御  
  - **認証・認可**  
    - ユーザーログイン、JWT またはセッション管理  
    - ロール（メンバー、プロジェクト管理者、システム管理者）に基づくアクセス制限  

- **本番環境デプロイ**  
  - AWS Lambda 上で実行し、API Gateway (HTTP API) から呼び出し  
  - AI アシスト部分は Lambda 内部ロジックで **Amazon Bedrock** を利用  

#### 3.2.3 データベース (PostgreSQL)

- **役割**  
  - タスク情報、ユーザー・グループ、コメント、ステータスなどを永続的に保存。  
  - 階層構造を持つ子タスクデータも管理する。  

- **本番環境**  
  - Amazon Aurora Serverless v2 (PostgreSQL 互換) を利用し、必要に応じて自動スケーリング  
  - Prisma ORM を通じてバックエンド (Node.js) からアクセス  

- **機能概要**  
  - **タスクテーブル**: 親タスクID を持つことで階層構造を表現  
  - **ユーザーテーブル**: ロールや通知設定、ログイン情報 (パスワードハッシュ) を保持  
  - **ステータステーブル**: プロジェクト単位で追加・編集できるステータスを定義  
  - **タグ/コメントテーブル**: タスクと1対多または多対多の関係を管理  

#### 3.2.4 AI アシスト (Amazon Bedrock)

- **役割**  
  - タスク内容から適切な子タスクを自動生成する生成系 AI サービス。  
  - 例: 「ウェブサイトリニューアル」タスクに対して、デザイン、コーディング、テストなどの子タスクを提案。  

- **実装パターン**  
  - **Amazon Bedrock** は AWS 上で提供されるフルマネージドの生成系 AI サービス。  
  - バックエンド Lambda 内で Bedrock の API を呼び出し、返却された生成結果をタスク候補としてユーザーに提示。  

- **注意点**  
  - ベースモデルやプロンプト設計に応じて、返されるタスク内容が変化するため、運用時には適切なチューニング・評価が必要。  
  - クレデンシャルやリクエスト数に応じた課金など、AWS 側の利用上限設定を考慮。  

#### 3.2.5 通知・メンション機能

- **役割**  
  - ステータス変更やコメントでメンションされたユーザーへ、リアルタイムまたは準リアルタイムで通知。  
  - グループ担当の場合の通知ルール（グループメンバーへの一斉通知 or 操作者除外 etc.）を実装。  

- **実装概要**  
  - **バックエンド**: ステータス変更やコメント投稿をフックに、通知キューを生成  
  - **通知送信**:  
    - システム内 UI 通知（フロントエンドでバッジ表示）  
    - 将来的にメール / Slack / プッシュ通知 連携も追加可能  

- **データ管理**  
  - 「既読 / 未読」情報を DB で管理し、各ユーザーが通知を確認済みかどうかを追跡。  